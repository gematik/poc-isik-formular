import"./modulepreload-polyfill-B5Qt9EMX.js";import{d as S,e as p,S as m,n as w,g as R,f as A,h as L}from"./smart-aX28uhIB.js";const c=document.getElementById("status"),e=document.getElementById("details");function r(t,n={}){c&&(n.html?c.innerHTML=t:c.textContent=t)}function i(t){e&&(t?(e.hidden=!1,e.textContent=JSON.stringify(t,null,2)):(e.hidden=!0,e.textContent=""))}function U(t,n){r(t),i(n),document.body.classList.add("error")}async function T(){try{S(),p();const t=new URLSearchParams(window.location.search);if(!(Array.from(t.keys()).length>0)){const h=`${window.location.origin}${window.location.pathname}`;r(`Um den SMART App Launch zu testen, nutzen Sie bitte die <a href="https://launch.smarthealthit.org/" target="_blank" rel="noopener">SMART Health IT Sandbox</a> und geben Sie <a href="${h}" target="_blank" rel="noopener">${h}</a> als Launch URL an.`,{html:!0}),i(null);return}const a=t.get("iss")?.trim();if(!a)throw new Error('SMART launch parameter "iss" fehlt in der URL.');const l=t.get("launch")?.trim()||null,s=t.get("client_id")?.trim()||m.clientId,o=t.get("scope")?.trim()||m.scope,u=t.get("redirect_uri")?.trim(),d=u?w(u):R();r("SMART Konfiguration wird geladen ..."),i({iss:a,launch:l,clientId:s,scope:o,redirectUri:d});const{authorizationUrl:f,pending:g}=await A({iss:a,launch:l,clientId:s,scope:o,redirectUri:d});L({...g,pkceMethod:"S256"}),r("Weiterleitung zum Authorization Server ..."),i(null),window.location.assign(f)}catch(t){console.error("SMART launch failed",t),U(t?.message||String(t),{stack:t?.stack})}}T();
